# Translation Sequence Diagram

Generated by CodeRabbit during PR review - documents the translation parameter flow and decision logic.

```mermaid
sequenceDiagram
  autonumber
  actor User
  participant GUI as VidScaler GUI
  participant Translator as translator.translate_srt
  participant Provider as OpenAI/Other

  User->>GUI: Click "Translate"
  GUI->>Translator: translate_srt(input, src, tgt, method, video, whisper_model, de_readability_optimization)
  alt tgt startswith "de" and de_readability_optimization
    note right of Translator #D6EAF8: DE STRICT TIMING\npreserve_timing=True
  else tgt startswith "de"
    note right of Translator #FDF2E9: DE EXPANSION\nexpand_timing + env params
  else
    note right of Translator #F2F9F3: Default conservative settings
  end
  Translator->>Translator: Analyze input SRT (segments, timings)
  Translator->>Provider: Translate (OpenAI or fallback)
  Translator->>Translator: Analyze output SRT (segments, timings)
  Translator-->>GUI: Output SRT path
  GUI-->>User: Show completion
```

## Key Decision Points

1. **DE STRICT TIMING**: When `de_readability_optimization=True` + German target
   - Uses `preserve_timing=True` for video burn-in compatibility
   - May lose segments that don't fit timing constraints

2. **DE EXPANSION**: Default German mode without strict optimization
   - Uses timing expansion with environment-configurable parameters
   - Better text readability, may extend timing windows

3. **Conservative Settings**: Non-German targets
   - Standard wrap width and timing preservation
   - Minimal modifications to original timing

## Generated By
- **CodeRabbit AI Code Review**
- **Date**: 2025-09-13
- **PR**: #5 - SRT defaults and project organization